<?xml version="1.0" encoding="utf-8"?>
<Policy xmlns="urn:schemas-microsoft-com:sipolicy" PolicyType="Base Policy">
  <VersionEx>1.0.0.0</VersionEx>
  <PlatformID>{{PLATFORM_ID}}</PlatformID>
  <Rules>
    <Rule>
      <Option>Enabled:Unsigned System Integrity Policy</Option>
    </Rule>
    <Rule>
      <Option>{{MODE}}</Option>
    </Rule>
    <Rule>
      <Option>Enabled:Advanced Boot Options Menu</Option>
    </Rule>
    <Rule>
      <Option>Required:Enforce Store Applications</Option>
    </Rule>
    <Rule>
      <Option>Enabled:UMCI</Option>
    </Rule>
    <Rule>
      <Option>Enabled:Inherit Default Policy</Option>
    </Rule>
    <Rule>
      <Option>Enabled:Dynamic Code Security</Option>
    </Rule>
    <Rule>
      <Option>Enabled:Revoked Expired As Unsigned</Option>
    </Rule>
  </Rules>
  <!--EKUS-->
  <EKUs>
    <Eku Id="ID_EKU_STORE" Value="{{WINDOWS_STORE_EKU}}" FriendlyName="Windows Store EKU - 1.3.6.1.4.1.311.76.3.1 Windows Store" />
  </EKUs>
  <!--File Rules-->
  <FileRules>
    <!--Allow Windows Publisher-->
    <Allow ID="ID_ALLOW_WINDOWS_PUBLISHER_1" FriendlyName="Allow Windows Publisher - Microsoft Corporation" FileName="*" MinimumFileVersion="0.0.0.0">
      <Signer Id="ID_SIGNER_WINDOWS_PUBLISHER_1">
        <CertRoot Type="TBS" Value="{{MICROSOFT_CODE_SIGNING_ROOT}}" />
        <CertEKU ID="ID_EKU_STORE" />
      </Signer>
    </Allow>
    <!--Allow Microsoft Product Signing-->
    <Allow ID="ID_ALLOW_MS_PRODUCT_SIGNING" FriendlyName="Allow Microsoft Product Signing" FileName="*" MinimumFileVersion="0.0.0.0">
      <Signer Id="ID_SIGNER_MS_PRODUCT_SIGNING">
        <CertRoot Type="TBS" Value="{{MICROSOFT_PRODUCT_SIGNING_ROOT}}" />
      </Signer>
    </Allow>
    <!--Allow applications in Program Files-->
    <Allow ID="ID_ALLOW_PROGRAM_FILES" FriendlyName="Allow Program Files" FileName="*" FilePath="{{PROGRAM_FILES_PATH}}\*" />
    <Allow ID="ID_ALLOW_PROGRAM_FILES_X86" FriendlyName="Allow Program Files x86" FileName="*" FilePath="{{PROGRAM_FILES_X86_PATH}}\*" />
    <!--Allow Windows folder-->
    <Allow ID="ID_ALLOW_WINDOWS_FOLDER" FriendlyName="Allow Windows Folder" FileName="*" FilePath="{{WINDOWS_FOLDER_PATH}}\*" />
    <!--Deny executables in user downloads folder-->
    <Deny ID="ID_DENY_DOWNLOADS_FOLDER" FriendlyName="Deny Downloads Folder Executables" FileName="*" FilePath="{{DOWNLOADS_PATH}}\*" />
    <!--Deny executables in user temp folder-->
    <Deny ID="ID_DENY_TEMP_FOLDER" FriendlyName="Deny Temp Folder Executables" FileName="*" FilePath="{{TEMP_PATH}}\*" />
    <!--Deny executables in public folders-->
    <Deny ID="ID_DENY_PUBLIC_FOLDERS" FriendlyName="Deny Public Folder Executables" FileName="*" FilePath="{{PUBLIC_PATH}}\*" />
    <!--Deny executables in user profiles-->
    <Deny ID="ID_DENY_USER_PROFILES" FriendlyName="Deny User Profile Executables" FileName="*" FilePath="%OSDRIVE%\Users\*\*" />
  </FileRules>
  <!--Signers-->
  <Signers>
    <Signer Name="Microsoft Product Signing" ID="ID_SIGNER_MS_PRODUCT_SIGNING">
      <CertRoot Type="TBS" Value="{{MICROSOFT_PRODUCT_SIGNING_ROOT}}" />
    </Signer>
    <Signer Name="Microsoft Code Signing PCA 2011" ID="ID_SIGNER_MICROSOFT_CODE_SIGNING">
      <CertRoot Type="TBS" Value="{{MICROSOFT_CODE_SIGNING_ROOT}}" />
    </Signer>
    <Signer Name="Windows Store" ID="ID_SIGNER_WINDOWS_PUBLISHER_1">
      <CertRoot Type="TBS" Value="{{MICROSOFT_CODE_SIGNING_ROOT}}" />
      <CertEKU ID="ID_EKU_STORE" />
    </Signer>
  </Signers>
  <!--Driver Signing Scenarios-->
  <SigningScenarios>
    <SigningScenario Value="131" ID="ID_SIGNINGSCENARIO_DRIVERS_1" FriendlyName="Auto generated policy on {{GENERATION_DATE}}">
      <ProductSigners>
        <AllowedSigners>
          <AllowedSigner SignerId="ID_SIGNER_MS_PRODUCT_SIGNING" />
          <AllowedSigner SignerId="ID_SIGNER_MICROSOFT_CODE_SIGNING" />
        </AllowedSigners>
        <FileRulesRef>
          <FileRuleRef RuleID="ID_ALLOW_PROGRAM_FILES" />
          <FileRuleRef RuleID="ID_ALLOW_PROGRAM_FILES_X86" />
          <FileRuleRef RuleID="ID_ALLOW_WINDOWS_FOLDER" />
          <FileRuleRef RuleID="ID_DENY_DOWNLOADS_FOLDER" />
          <FileRuleRef RuleID="ID_DENY_TEMP_FOLDER" />
          <FileRuleRef RuleID="ID_DENY_PUBLIC_FOLDERS" />
          <FileRuleRef RuleID="ID_DENY_USER_PROFILES" />
        </FileRulesRef>
      </ProductSigners>
    </SigningScenario>
    <SigningScenario Value="12" ID="ID_SIGNINGSCENARIO_WINDOWS" FriendlyName="Windows">
      <ProductSigners>
        <AllowedSigners>
          <AllowedSigner SignerId="ID_SIGNER_WINDOWS_PUBLISHER_1" />
          <AllowedSigner SignerId="ID_SIGNER_MS_PRODUCT_SIGNING" />
          <AllowedSigner SignerId="ID_SIGNER_MICROSOFT_CODE_SIGNING" />
        </AllowedSigners>
        <FileRulesRef>
          <FileRuleRef RuleID="ID_ALLOW_PROGRAM_FILES" />
          <FileRuleRef RuleID="ID_ALLOW_PROGRAM_FILES_X86" />
          <FileRuleRef RuleID="ID_ALLOW_WINDOWS_FOLDER" />
          <FileRuleRef RuleID="ID_DENY_DOWNLOADS_FOLDER" />
          <FileRuleRef RuleID="ID_DENY_TEMP_FOLDER" />
          <FileRuleRef RuleID="ID_DENY_PUBLIC_FOLDERS" />
          <FileRuleRef RuleID="ID_DENY_USER_PROFILES" />
        </FileRulesRef>
      </ProductSigners>
    </SigningScenario>
  </SigningScenarios>
  <UpdatePolicySigners>
  </UpdatePolicySigners>
  <CiSigners>
    <CiSigner SignerId="ID_SIGNER_MS_PRODUCT_SIGNING" />
    <CiSigner SignerId="ID_SIGNER_MICROSOFT_CODE_SIGNING" />
  </CiSigners>
  <HvciOptions>0</HvciOptions>
  <Settings>
    <Setting Provider="AllHostIds" Key="EnterpriseDefinedConfiguration#D76C934D-6947-4795-BC27-D84E33CF4354" ValueName="EnableHVCI">
      <Value>
        <Boolean>true</Boolean>
      </Value>
    </Setting>
  </Settings>
</Policy>